<!DOCTYPE html><html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Hyper-Bot üéì</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    :root{
      --bg:#eef2f7;
      --primary:#1976d2;
      --primary-dark:#115293;
      --surface:#ffffff;
      --user:#c8e6c9;
      --bot:#e0e0e0;
      --radius:10px;
    }
    *{box-sizing:border-box;font-family:"Segoe UI",Arial,sans-serif;}
    body{margin:0;display:flex;flex-direction:column;height:100vh;background:var(--bg);color:#333;}
    header{background:var(--primary);color:#fff;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 6px rgba(0,0,0,.15);} 
    header h1{margin:0;font-size:1.1rem;font-weight:600;display:flex;align-items:center;gap:6px;}
    .hamburger{width:24px;height:18px;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer;}
    .hamburger span{height:3px;background:#fff;border-radius:2px;}
    details{position:relative;}
    .menu{position:absolute;right:0;top:42px;background:var(--surface);border-radius:var(--radius);box-shadow:0 4px 12px rgba(0,0,0,.15);padding:12px;display:flex;flex-direction:column;gap:8px;min-width:200px;z-index:10;opacity:0;transform:translateY(-6px);pointer-events:none;transition:.2s;}
    details[open]>.menu{opacity:1;transform:translateY(0);pointer-events:auto;}
    .menu button{padding:8px 12px;border:none;border-radius:var(--radius);background:var(--primary);color:#fff;cursor:pointer;font-size:.9rem;transition:.2s;}
    .menu button:hover{background:var(--primary-dark);} main{flex:1 1 auto;display:flex;flex-direction:column;padding:16px;gap:14px;overflow:hidden;}
textarea,input{border:1px solid #cbd5e1;border-radius:var(--radius);padding:10px;font-size:1rem;background:#f9fafb;}
textarea{resize:vertical;min-height:90px;}
.hidden{display:none;}

#chat{flex:1 1 auto;background:var(--surface);border-radius:var(--radius);padding:12px;overflow-y:auto;box-shadow:0 2px 8px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:10px;}
.msg{max-width:80%;padding:8px 10px;border-radius:var(--radius);white-space:pre-wrap;word-wrap:break-word;box-shadow:0 1px 3px rgba(0,0,0,.08);}
.user{align-self:flex-end;background:var(--user);} 
.bot{align-self:flex-start;background:var(--bot);} 

.input-bar{display:flex;gap:10px;}
.input-bar input{flex:1 1 auto;}
.send{background:var(--primary);color:#fff;border:none;border-radius:var(--radius);padding:0 18px;font-size:1rem;cursor:pointer;transition:.2s;}
.send:hover{background:var(--primary-dark);} 

@media(max-width:600px){header h1{font-size:.95rem;} .menu{right:50%;transform:translateX(50%);} }

  </style>
</head>
<body>
  <header>
    <h1>Hyper-Bot üéì</h1>
    <details>
      <summary class="hamburger" aria-label="–ú–µ–Ω—é"><span></span><span></span><span></span></summary>
      <div class="menu">
        <button onclick="showTrainText()">–û–±—É—á–∏—Ç—å –ø–æ —Ç–µ–∫—Å—Ç—É</button>
        <button onclick="showTrainURL()">–û–±—É—á–∏—Ç—å –ø–æ URL</button>
        <button onclick="showAnalysis()">–ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∞–ª–∏–∑</button>
        <button onclick="exportData()">–°–∫–∞—á–∞—Ç—å –ø–∞–º—è—Ç—å</button>
        <button onclick="document.getElementById('fileInput').click()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–∞–º—è—Ç—å</button>
        <button onclick="clearChat()">–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç</button>
      </div>
    </details>
  </header>  <main>
    <section id="trainText" class="hidden">
      <textarea id="textInput" placeholder="–í—Å—Ç–∞–≤—å —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è‚Ä¶"></textarea>
      <button class="send" style="margin-top:8px" onclick="trainFromText();hideSections();">–û–±—É—á–∏—Ç—å</button>
    </section><section id="trainURL" class="hidden" style="display:flex;gap:10px;flex-wrap:wrap;align-items:flex-start;">
  <input id="urlInput" placeholder="–í—Å—Ç–∞–≤—å URL –¥–ª—è –æ–±—É—á–µ–Ω–∏—è" style="flex:1 1 280px;min-width:200px;">
  <button class="send" onclick="trainFromURL();hideSections();">–ó–∞–≥—Ä—É–∑–∏—Ç—å URL</button>
</section>

<div id="chat"></div>

<div class="input-bar">
  <input id="userInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶" onkeydown="if(event.key==='Enter'){ask();}">
  <button class="send" onclick="ask()">‚û§</button>
</div>

  </main>  <input type="file" id="fileInput" accept="application/json" class="hidden" onchange="importData(event)"><script>
  /* ======= –®–ê–ë–õ–û–ù–´ PowerShell ======= */
  const templates=[
    {
      pattern:/—Å–æ–∑–¥–∞—Ç—å vhdx (?<size>\d+(?:gb|mb)) –≤ (?<path>.+)/i,
      script:({size,path})=>`
# –°–æ–∑–¥–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π VHDX
$vhdPath = \"${path}\\VirtualDisk.vhdx\"
New-VHD -Path $vhdPath -SizeBytes ${size.toUpperCase()} -Dynamic
Mount-VHD -Path $vhdPath
$disk = (Get-Disk | ? IsOffline -eq $false | Select -Last 1)
Initialize-Disk -Number $disk.Number -PartitionStyle GPT
New-Partition -DiskNumber $disk.Number -UseMaximumSize -AssignDriveLetter |
  Format-Volume -FileSystem NTFS -NewFileSystemLabel \"Data\"`},

    {
      pattern:/–∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ (?<letter>[a-z]): —Å –∫–ª—é—á–æ–º –≤ (?<keyPath>.+)/i,
      script:({letter,keyPath})=>`Enable-BitLocker -MountPoint \"${letter.toUpperCase()}:\" -RecoveryKeyPath \"${keyPath}\" -EncryptionMethod XtsAes256`},

    {pattern:/–ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã/i,script:()=>`Get-Process | Sort-Object CPU -desc | Select -First 25`},

    {pattern:/—É–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (?<name>\S+)/i,script:({name})=>`Stop-Process -Name \"${name}\" -Force`}
  ];
  function templateMatch(q){for(const t of templates){const m=q.match(t.pattern);if(m)return typeof t.script==='function'?t.script(m.groups||{}):t.script;}
    return null;}

  /* ======= –ü–∞–º—è—Ç—å ======= */
  let knowledgeBase=JSON.parse(localStorage.getItem('knowledgeBase')||'[]');
  let corpus=JSON.parse(localStorage.getItem('corpus')||'[]');
  function saveAll(){localStorage.setItem('knowledgeBase',JSON.stringify(knowledgeBase));localStorage.setItem('corpus',JSON.stringify(corpus));}

  /* ===== helper UI ===== */
  function hideSections(){trainText.classList.add('hidden');trainURL.classList.add('hidden');}
  function showTrainText(){hideSections();trainText.classList.remove('hidden');}
  function showTrainURL(){hideSections();trainURL.classList.remove('hidden');}
  const stopW=new Set(['–∏','–≤','–≤–æ','–Ω–µ','—á—Ç–æ','–æ–Ω','–Ω–∞','—è','—Å','—Å–æ','–∫–∞–∫','–∞','—Ç–æ','–≤—Å–µ','–æ–Ω–∞','–Ω–æ','–¥–∞','—Ç—ã','–∫','—É','–∂–µ','–≤—ã','–∑–∞','–±—ã','–ø–æ','—Ç–æ–ª—å–∫–æ','–µ–µ','–º–Ω–µ','–±—ã–ª–æ','–≤–æ—Ç','–æ—Ç','–º–µ–Ω—è','–µ—â–µ','–Ω–µ—Ç','–æ','–∏–∑','–µ–º—É','—Ç–µ–ø–µ—Ä—å','–∫–æ–≥–¥–∞','–¥–∞–∂–µ','–Ω—É','–≤–¥—Ä—É–≥','–ª–∏','–µ—Å–ª–∏','—É–∂–µ','–∏–ª–∏','–Ω–∏','–±—ã—Ç—å','–±—ã–ª','–Ω–µ–≥–æ','–¥–æ','–≤–∞—Å','–Ω–∏–±—É–¥—å','—É–∂','–≤–∞–º','–≤–µ–¥—å','—Ç–∞–º','–ø–æ—Ç–æ–º','—Å–µ–±—è','–Ω–∏—á–µ–≥–æ','–µ–π','–º–æ–∂–µ—Ç','–æ–Ω–∏','—Ç—É—Ç','–≥–¥–µ','–µ—Å—Ç—å','–Ω–∞–¥–æ','–Ω–µ–π','–¥–ª—è','–º—ã','—Ç–µ–±—è','–∏—Ö','—á–µ–º','–±—ã–ª–∞','—Å–∞–º','—á—Ç–æ–±','–±–µ–∑','–±—É–¥—Ç–æ','—á–µ–≥–æ','—Ä–∞–∑','—Ç–æ–∂–µ','—Å–µ–±–µ','–ø–æ–¥','–±—É–¥–µ—Ç','–∂','—Ç–æ–≥–¥–∞','–∫—Ç–æ','—ç—Ç–æ—Ç','—Ç–æ–≥–æ','–ø–æ—Ç–æ–º—É','—ç—Ç–æ–≥–æ','–∫–∞–∫–æ–π','—Å–æ–≤—Å–µ–º','–Ω–∏–º','–∑–¥–µ—Å—å','—ç—Ç–æ–º','–æ–¥–∏–Ω','–ø–æ—á—Ç–∏','–º–æ–π','—Ç–µ–º','—á—Ç–æ–±—ã','–Ω–µ–µ','—Å–µ–π—á–∞—Å','–±—ã–ª–∏','–∫—É–¥–∞','–∑–∞—á–µ–º']);
  function sentences(t){return t.split(/[.!?\n]+/).map(s=>s.trim()).filter(Boolean);}  

  /* ===== Training ===== */
  function trainFromText(){const t=textInput.value.trim();if(!t)return alert('–¢–µ–∫—Å—Ç?');const s=sentences(t);s.forEach(x=>{knowledgeBase.push({request:x.toLowerCase(),answer:x});corpus.push(x);});saveAll();append('–ò–ò',`–û–±—É—á–µ–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: ${s.length}`,'bot');}
  async function trainFromURL(){const u=urlInput.value.trim();if(!u)return alert('URL?');try{const proxy='https://api.allorigins.win/get?url='+encodeURIComponent(u);const res=await fetch(proxy);const data=await res.json();const doc=new DOMParser().parseFromString(data.contents,'text/html');const text=Array.from(doc.querySelectorAll('p')).map(p=>p.textContent.trim()).join(' ');const s=sentences(text);s.forEach(x=>{knowledgeBase.push({request:x.toLowerCase(),answer:x});corpus.push(x);});saveAll();append('–ò–ò',`–° URL –æ–±—É—á–µ–Ω–æ: ${s.length}`,'bot');}catch(e){alert('–û—à–∏–±–∫–∞ URL: '+e.message);} }

  /* ===== Backup ===== */
  function exportData(){const blob=new Blob([JSON.stringify({knowledgeBase,corpus})],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='bot-memory.json';a.click();URL.revokeObjectURL(url);}  
  function importData(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{try{const d=JSON.parse(ev.target.result);if(Array.isArray(d.knowledgeBase)&&Array.isArray(d.corpus)){knowledgeBase=d.knowledgeBase;corpus=d.corpus;saveAll();append('–ò–ò','–ü–∞–º—è—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!','bot');}else throw'—Ñ–æ—Ä–º–∞—Ç';}catch(er){alert('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: '+er);}};r.readAsText(f);}  

  /* ===== Analysis ===== */
  function analysis(){if(!corpus.length)return'–ö–æ—Ä–ø—É—Å –ø—É—Å—Ç!';let total=0,freq={};corpus.forEach(s=>s.toLowerCase().split(/[^\p{L}0-9]+/u).forEach(w=>{if(!w||stopW.has(w))return;total++;freq[w]=(freq[w]||0)+1;}));const avg=(total/corpus.length).toFixed(1),top=Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,10).map(([w,c])=>`${w}(${c})`).join(', ');return`–í—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: ${corpus.length}\n–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞: ${avg} —Å–ª–æ–≤\n–¢–æ–ø-10 —Å–ª–æ–≤: ${top}`;}
  function showAnalysis(){append('–ò–ò',analysis(),'bot');hideSections();}

  /* ===== Chat ===== */
  function sim(a,b){const w1=a.split(/\s+/),w2=b.split(/\s+/);const i=w1.filter(x=>w2.includes(x)).length;return i/Math.max(w1.length,w2.length);}  
  function kb(q){let best=null,s=0;knowledgeBase.forEach(e=>{const sc=sim(q,e.request);if(sc>s){s=sc;best=e;}});return s>0.35?best.answer:null;}  
  function append(sender,text,cls){const d=document.createElement('div');d.className=`msg ${cls}`;d.textContent=`${sender}: ${text}`;chat.appendChild(d);chat.scrollTop=chat.scrollHeight;}
  function clearChat(){chat.innerHTML='';}
  function ask(){const q=userInput.value.trim();if(!q)return;userInput.value='';append('–¢—ã',q,'user');if(/^–∞–Ω–∞–ª–∏–∑( —Ç–µ–∫—Å—Ç–∞)?$/i.test(q)){append('–ò–ò',analysis(),'bot');return;}
    if(q.includes(' - ')){const [req,ans]=q.split(' - ').map(s=>s.trim());if(req&&ans){knowledgeBase.push({request:req.toLowerCase(),answer:ans});saveAll();append('–ò–ò','–ó–∞–ø–æ–º–Ω–∏–ª!','bot');}return;}
    let ans=templateMatch(q.toLowerCase())||kb(q.toLowerCase())||'–ù–µ –∑–Ω–∞—é‚Ä¶ –û–±—É—á–∏ –º–µ–Ω—è –∏–ª–∏ –¥–∞–π —Å—Å—ã–ª–∫—É!';append('–ò–ò',ans,'bot');}
</script></body>
</html>
