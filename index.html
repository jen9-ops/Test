<!DOCTYPE html><html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä PS1/Batch —Å–∫—Ä–∏–ø—Ç–æ–≤</title>
  <style>
    body { font-family: Arial, sans-serif; background:#fafafa; padding:20px; }
    .box { max-width:600px; margin:auto; background:#fff; padding:20px;
           border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .box label { display:block; margin:12px 0 4px; }
    .box textarea, .box select, .box button, .box input[type="checkbox"] { width:100%; padding:8px; box-sizing:border-box; }
    #editor { height: 250px; border:1px solid #ddd; border-radius:4px; margin-top:10px; }
    .controls { display: flex; gap:10px; margin-top:10px; }
    .controls > * { flex:1; }
    .inline { display: inline-block; width: auto; margin-right: 10px; }
    .hidden { display: none; }
  </style>
  <!-- Ace Editor CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.11.2/ace.js" integrity="sha512-+GiXKP3jjxmclXKt5ydEmx64nkNykyBVy884hcXChzraJEjz/UNj4KfULtti6VyIwKHUr+T2D4XUl5SH2+NMog==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <div class="box">
    <h2>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä PS1/Batch —Å–∫—Ä–∏–ø—Ç–æ–≤</h2><label for="commands">–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É):</label>
<textarea id="commands" rows="5" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:\nGet-Process\nStop-Computer -Force"></textarea>

<label for="lang">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Å–∫—Ä–∏–ø—Ç–∞:</label>
<select id="lang">
  <option value="ps1">PowerShell (.ps1)</option>
  <option value="bat">Batch (.bat)</option>
</select>

<label class="inline"><input type="checkbox" id="compileExe" /> –ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –≤ .exe</label>

<div class="controls">
  <button id="gen">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
  <a id="downloadScript" class="hidden" style="text-align:center; padding:8px; background:#0078d4; color:#fff; text-decoration:none; border-radius:4px;">–°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç</a>
  <a id="downloadExe" class="hidden" style="text-align:center; padding:8px; background:#28a745; color:#fff; text-decoration:none; border-radius:4px;">–°–∫–∞—á–∞—Ç—å .exe</a>
</div>

<div id="editor"># –í–∞—à —Å–∫—Ä–∏–ø—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å‚Ä¶</div>

  </div>  <script>
    // Endpoint —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
    const COMPILE_API = 'https://compile-service.example.com/api/compile';

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ace
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome");
    editor.session.setMode("ace/mode/powershell");
    editor.setOptions({ fontSize: "14px", wrap: true, showPrintMargin: false });

    const cmdArea     = document.getElementById('commands');
    const langSelect  = document.getElementById('lang');
    const compileChk  = document.getElementById('compileExe');
    const genBtn      = document.getElementById('gen');
    const dlScript    = document.getElementById('downloadScript');
    const dlExe       = document.getElementById('downloadExe');

    function aceMode(lang) {
      return lang === 'ps1' ? "ace/mode/powershell" : "ace/mode/batchfile";
    }

    genBtn.onclick = async () => {
      const commands = cmdArea.value.trim();
      const lang     = langSelect.value;
      const compile  = compileChk.checked;

      if (!commands) {
        alert('–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É');
        return;
      }

      // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞
      let script = '';
      if (lang === 'ps1') {
        script = commands.split(/\r?\n/).join('\n');
      } else {
        script = '@echo off\n' + commands.split(/\r?\n/).join('\n');
      }

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
      editor.session.setMode(aceMode(lang));
      editor.setValue(script, -1);

      // –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
      const blob = new Blob([script], { type: 'text/plain;charset=utf-8' });
      const url  = URL.createObjectURL(blob);
      dlScript.href         = url;
      dlScript.download     = `script.${lang}`;
      dlScript.textContent  = 'üì• –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç';
      dlScript.classList.remove('hidden');

      // –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è
      if (compile) {
        try {
          const res = await fetch(COMPILE_API, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ script, lang })
          });
          if (!res.ok) throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${res.status}`);
          const blobExe = await res.blob();
          const exeUrl   = URL.createObjectURL(blobExe);
          dlExe.href       = exeUrl;
          dlExe.download   = 'script.exe';
          dlExe.textContent= 'üì• –°–∫–∞—á–∞—Ç—å .exe';
          dlExe.classList.remove('hidden');
        } catch (e) {
          alert('–ö–æ–º–ø–∏–ª—è—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å: ' + e.message);
        }
      } else {
        dlExe.classList.add('hidden');
      }
    };
  </script></body>
</html>
