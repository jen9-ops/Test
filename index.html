<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º</title>
  <style>
    body { font-family: Arial, sans-serif; background:#fafafa; padding:20px; }
    .box { max-width:600px; margin:auto; background:#fff; padding:20px;
           border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .box label { display:block; margin:12px 0 4px; }
    .box input, .box select, .box button { width:100%; padding:8px; box-sizing:border-box; }
    #editor { height: 300px; border:1px solid #ddd; border-radius:4px; margin-top:10px; }
    .controls { display: flex; gap:10px; margin-top:10px; }
    .controls > * { flex:1; }
  </style>
  <!-- Ace Editor from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.11.2/ace.js" integrity="sha512-+GiXKP3jjxmclXKt5ydEmx64nkNykyBVy884hcXChzraJEjz/UNj4KfULtti6VyIwKHUr+T2D4XUl5SH2+NMog==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <div class="box">
    <h2>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤</h2>

    <label for="cmd">–ö–æ–º–∞–Ω–¥–∞ (–Ω–∞–ø—Ä., ¬´–≤—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ 20 –º–∏–Ω—É—Ç¬ª)</label>
    <input id="cmd" type="text" placeholder="–≤–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞‚Ä¶" />

    <label for="lang">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫/—Ñ–æ—Ä–º–∞—Ç —Å–∫—Ä–∏–ø—Ç–∞:</label>
    <select id="lang">
      <option value="ps1">PowerShell (.ps1)</option>
      <option value="bat">Batch (.bat)</option>
      <option value="js">JavaScript (.js)</option>
      <option value="html">HTML (.html)</option>
      <option value="css">CSS (.css)</option>
    </select>

    <div class="controls">
      <button id="gen">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
      <a id="download" style="display:none; text-align:center; padding:8px; background:#0078d4; color:#fff; text-decoration:none; border-radius:4px;">–°–∫–∞—á–∞—Ç—å</a>
    </div>

    <div id="editor"># –ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤–∞—à —Å–∫—Ä–∏–ø—Ç‚Ä¶</div>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ace
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome");
    editor.session.setMode("ace/mode/powershell");
    editor.setOptions({ fontSize: "14px", wrap: true });

    const cmdInput = document.getElementById('cmd');
    const langSelect = document.getElementById('lang');
    const genBtn = document.getElementById('gen');
    const dlLink = document.getElementById('download');

    function getScript(text, lang) {
      let m, secs, script;
      const minutes = (n) => parseInt(n,10)*60;
      if (m = text.match(/–≤—ã–∫–ª—é—á–∏—Ç—å.*—á–µ—Ä–µ–∑\s*(\d+)\s*–º–∏–Ω/)) {
        secs = minutes(m[1]);
        switch(lang) {
          case 'ps1':
            return `Start-Sleep -Seconds ${secs}\nStop-Computer -Force`;
          case 'bat':
            return `@echo off\ntimeout /t ${secs} /nobreak >nul\nshutdown /s /f`;
          case 'js':
            return `setTimeout(function() {\n  /* –∑–¥–µ—Å—å –Ω–∏–∫–∞–∫–æ–≥–æ shutdown –≤ JS –Ω–µ—Ç */\n  alert("–í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ!");\n}, ${secs}000);`;
          case 'html':
            return `<!DOCTYPE html>\n<html><head><meta charset="UTF-8"><title>–¢–∞–π–º–µ—Ä</title>\n<script>\n${getScript(text,'js')}\n</script>\n</head><body>\n<p>–û–∫–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ ${m[1]} –º–∏–Ω.</p>\n</body></html>`;
          case 'css':
            return `/* CSS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–π–º–µ—Ä—ã –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ */\n/* –í–æ–∑–º–æ–∂–Ω–æ, –≤—ã —Ö–æ—Ç–µ–ª–∏ JS –∏–ª–∏ PS1 */`;
        }
      }
      else {
        // –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ
        return {
          ps1: `# –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É\n`,
          bat: `@echo off\necho –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É\npause`,
          js: `// –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É`,
          html: `<!-- –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É -->`,
          css: `/* –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É */`
        }[lang];
      }
    }

    function aceMode(lang) {
      return {
        ps1: "ace/mode/powershell",
        bat: "ace/mode/batchfile",
        js: "ace/mode/javascript",
        html:"ace/mode/html",
        css:"ace/mode/css"
      }[lang];
    }

    genBtn.onclick = () => {
      const text = cmdInput.value.trim().toLowerCase();
      const lang = langSelect.value;
      const script = getScript(text, lang);
      editor.session.setMode(aceMode(lang));
      editor.setValue(typeof script==='string'? script : script.trim(), -1);

      // –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Å—ã–ª–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
      const blob = new Blob([editor.getValue()], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      dlLink.href = url;
      dlLink.download = `script.${lang === 'ps1'?'ps1':lang}`;
      dlLink.style.display = 'inline-block';
      dlLink.textContent = `üì• –°–∫–∞—á–∞—Ç—å script.${lang === 'ps1'?'ps1':lang}`;
    };
  </script>
</body>
</html>
