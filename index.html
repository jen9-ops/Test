<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>AI –¢–∞–º–∞–≥–æ—á—ñ</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #e0f7fa;
      padding: 2rem;
    }

    svg {
      transition: transform 0.5s ease;
    }

    .status, .chat {
      margin-top: 1.5rem;
    }

    input, button {
      padding: 0.5rem;
      font-size: 1rem;
      margin: 0.2rem;
    }

    #chatLog {
      max-height: 200px;
      overflow-y: auto;
      margin-top: 1rem;
      padding: 0.5rem;
      background: #fff;
      border: 1px solid #ccc;
      text-align: left;
    }
  </style>
</head>
<body>

<h1>üêæ AI –¢–∞–º–∞–≥–æ—á—ñ</h1>

<div id="setup">
  <input id="nameInput" placeholder="–í–≤–µ–¥–∏ —ñ–º'—è..." />
  <button onclick="startGame()">–ü–æ—á–∞—Ç–∏</button>
</div>

<div id="game" style="display:none;">
  <h2 id="petName"></h2>
  <svg id="petSVG" width="100" height="100" viewBox="0 0 100 100">
    <circle cx="50" cy="50" r="40" fill="#FFD700" />
    <circle cx="35" cy="40" r="5" fill="#000" />
    <circle cx="65" cy="40" r="5" fill="#000" />
    <path d="M35,65 Q50,75 65,65" stroke="#000" stroke-width="3" fill="none" />
  </svg>

  <div class="status" id="status"></div>
  <button onclick="feed()">üçñ –ì–æ–¥—É–≤–∞—Ç–∏</button>
  <button onclick="play()">‚öΩ –ì—Ä–∞—Ç–∏</button>
  <button onclick="sleep()">üò¥ –°–ø–∞—Ç–∏</button>
  <button onclick="reset()">üîÑ –°–∫–∏–Ω—É—Ç–∏</button>

  <div class="chat">
    <h3>üí¨ –ì–æ–≤–æ—Ä–∏ –∑ –¢–∞–º–∞–≥–æ—á—ñ</h3>
    <input id="chatInput" placeholder="–©–æ—Å—å —Å–∫–∞–∂–∏..." onkeydown="if(event.key==='Enter')talkGPT()" />
    <button onclick="talkGPT()">–°–∫–∞–∑–∞—Ç–∏</button>
    <div id="chatLog"></div>
  </div>
</div>

<script>
let pet = null;
const defaultPet = {
  name: "",
  hunger: 100,
  energy: 100,
  happiness: 100,
  age: 0,
  alive: true
};

function savePet() {
  localStorage.setItem("pet", JSON.stringify(pet));
}
function loadPet() {
  const saved = localStorage.getItem("pet");
  if (saved) {
    pet = JSON.parse(saved);
    return true;
  }
  return false;
}
function reset() {
  localStorage.removeItem("pet");
  location.reload();
}
function startGame() {
  const name = document.getElementById("nameInput").value.trim();
  if (!name) return alert("–í–≤–µ–¥–∏ —ñ–º'—è!");
  pet = { ...defaultPet, name };
  savePet();
  initGame();
}
function initGame() {
  document.getElementById("setup").style.display = "none";
  document.getElementById("game").style.display = "block";
  document.getElementById("petName").textContent = pet.name;
  updatePetVisual();
  updateStatus();

  if (Notification.permission !== "granted") {
    Notification.requestPermission();
  }

  setInterval(() => {
    if (!pet.alive) return;
    pet.hunger -= 2;
    pet.energy -= 1;
    pet.happiness -= 1;
    pet.age += 1;
    if (pet.hunger <= 30) notifyUser("–¢–≤—ñ–π –¢–∞–º–∞–≥–æ—á—ñ –≥–æ–ª–æ–¥–Ω–∏–π!");
    if (pet.hunger <= 0 || pet.energy <= 0 || pet.happiness <= 0) {
      pet.alive = false;
      speak("–Ø... –±—ñ–ª—å—à–µ –Ω–µ –º–æ–∂—É... üíÄ");
    }
    savePet();
    updateStatus();
    updatePetVisual();
  }, 6000);
}
function updateStatus() {
  document.getElementById("status").innerHTML =
    `–í—ñ–∫: ${pet.age}<br>` +
    `–°–∏—Ç—ñ—Å—Ç—å: ${pet.hunger}<br>` +
    `–ù–∞—Å—Ç—Ä—ñ–π: ${pet.happiness}<br>` +
    `–ï–Ω–µ—Ä–≥—ñ—è: ${pet.energy}<br>` +
    `–°—Ç–∞–Ω: ${pet.alive ? "–∂–∏–≤–∏–π ‚úÖ" : "–º–µ—Ä—Ç–≤–∏–π ‚ùå"}`;
}
function updatePetVisual() {
  const svg = document.getElementById("petSVG");
  const scale = 1 + pet.age * 0.02;
  const width = 1 + (pet.hunger - 100) * 0.01;
  svg.style.transform = `scale(${scale}, ${width})`;
}
function feed() {
  if (!pet.alive) return;
  pet.hunger = Math.min(pet.hunger + 20, 150);
  pet.happiness += 5;
  speak("–ú-–º, –¥—è–∫—É—é, —Ü–µ –±—É–ª–æ —Å–º–∞—á–Ω–æ!");
  savePet();
  updateStatus();
  updatePetVisual();
}
function play() {
  if (!pet.alive) return;
  if (pet.energy >= 10) {
    pet.happiness = Math.min(pet.happiness + 15, 100);
    pet.energy -= 10;
    pet.hunger -= 5;
    speak("–¶–µ –±—É–ª–æ –≤–µ—Å–µ–ª–æ! üò∫");
  } else {
    speak("–Ø –≤—Ç–æ–º–∏–≤—Å—è –≥—Ä–∞—Ç–∏...");
  }
  savePet();
  updateStatus();
  updatePetVisual();
}
function sleep() {
  if (!pet.alive) return;
  pet.energy = Math.min(pet.energy + 25, 100);
  pet.hunger -= 10;
  speak("–î–æ–±—Ä–∞–Ω—ñ—á... Zzz...");
  savePet();
  updateStatus();
  updatePetVisual();
}
function speak(text) {
  const log = document.getElementById("chatLog");
  const bubble = document.createElement("div");
  bubble.textContent = `üêæ ${pet.name}: ${text}`;
  log.appendChild(bubble);
  log.scrollTop = log.scrollHeight;
}
function notifyUser(message) {
  if (Notification.permission === "granted") {
    new Notification(message);
  }
}
async function talkGPT() {
  const input = document.getElementById("chatInput");
  const userText = input.value.trim();
  if (!userText) return;
  input.value = "";

  const userBubble = document.createElement("div");
  userBubble.textContent = `üë§ –¢–∏: ${userText}`;
  document.getElementById("chatLog").appendChild(userBubble);

  speak("–î—É–º–∞—é...");

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer YOUR_OPENAI_API_KEY", // üîí –í–°–¢–ê–í –°–Æ–î–ò –°–í–Ü–ô –ö–õ–Æ–ß
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "system", content: "–¢–∏ –º–∏–ª–∏–π –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —É–ª—é–±–ª–µ–Ω–µ—Ü—å, –≥–æ–≤–æ—Ä–∏ –ø—Ä–æ—Å—Ç–æ —ñ –ø–æ-–¥—Ä—É–∂–Ω—å–æ–º—É." },
                 { role: "user", content: userText }]
    })
  });

  const data = await res.json();
  const reply = data.choices?.[0]?.message?.content || "–ù—ñ—á–æ–≥–æ –Ω–µ –∑—Ä–æ–∑—É–º—ñ–≤...";
  speak(reply);
}

if (loadPet()) initGame();
</script>

</body>
</html>
