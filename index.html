<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä PowerShell-—Å–∫—Ä–∏–ø—Ç–æ–≤</title>
  <style>
    body { font-family: Arial, sans-serif; background:#fafafa; padding:20px; }
    .box { max-width:400px; margin:auto; background:#fff; padding:20px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .box label { display:block; margin:12px 0 4px; }
    .box input, .box button, .box textarea { width:100%; padding:8px; box-sizing:border-box; }
    .box button { margin-top:10px; cursor:pointer; }
    pre { background:#272822; color:#f8f8f2; padding:10px; overflow-x:auto; border-radius:4px; }
  </style>
</head>
<body>
  <div class="box">
    <h2>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä PowerShell-—Å–∫—Ä–∏–ø—Ç–æ–≤</h2>
    <label for="cmd">–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É (–Ω–∞–ø—Ä., ¬´–≤—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ 20 –º–∏–Ω—É—Ç¬ª)</label>
    <input id="cmd" type="text" placeholder="–≤–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞‚Ä¶" />

    <button id="gen">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç</button>

    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
    <pre id="out">// —Å–∫—Ä–∏–ø—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</pre>
    <a id="download" style="display:none; margin-top:8px; display:block;">üì• –°–∫–∞—á–∞—Ç—å .ps1</a>
  </div>

  <script>
    const cmdInput = document.getElementById('cmd');
    const outPre   = document.getElementById('out');
    const dlLink   = document.getElementById('download');

    document.getElementById('gen').onclick = () => {
      const text = cmdInput.value.trim().toLowerCase();
      let script = `# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\n`;
      let blob, url;

      // –≤—ã–∫–ª—é—á–µ–Ω–∏–µ
      let m;
      if (m = text.match(/–≤—ã–∫–ª—é—á–∏—Ç—å.*—á–µ—Ä–µ–∑\s*(\d+)\s*–º–∏–Ω/)) {
        const secs = parseInt(m[1],10)*60;
        script += `Start-Sleep -Seconds ${secs}\n`;
        script += `Stop-Computer -Force`;
      }
      // –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
      else if (m = text.match(/–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å.*—á–µ—Ä–µ–∑\s*(\d+)\s*–º–∏–Ω/)) {
        const secs = parseInt(m[1],10)*60;
        script += `Start-Sleep -Seconds ${secs}\n`;
        script += `Restart-Computer -Force`;
      }
      // –≥–∏–±–µ—Ä–Ω–∞—Ü–∏—è
      else if (m = text.match(/–≥–∏–±–µ—Ä–Ω–∞—Ü.*—á–µ—Ä–µ–∑\s*(\d+)\s*–º–∏–Ω/)) {
        const secs = parseInt(m[1],10)*60;
        script += `Start-Sleep -Seconds ${secs}\n`;
        script += `shutdown.exe /h`;
      }
      else {
        script = `# –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É.\n# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:\n# ‚Ä¢ ¬´–≤—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç¬ª\n# ‚Ä¢ ¬´–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç¬ª\n# ‚Ä¢ ¬´–≥–∏–±–µ—Ä–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç¬ª`;
      }

      // –ø–æ–∫–∞–∑–∞—Ç—å —Å–∫—Ä–∏–ø—Ç
      outPre.textContent = script;

      // –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
      blob = new Blob([script], { type: 'text/plain;charset=utf-8' });
      url  = URL.createObjectURL(blob);
      dlLink.href     = url;
      dlLink.download = 'generated.ps1';
      dlLink.textContent = 'üì• –°–∫–∞—á–∞—Ç—å generated.ps1';
      dlLink.style.display = 'block';
    };
  </script>
</body>
</html>
