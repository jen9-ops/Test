<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üìù –ë–ª–æ–∫–Ω–æ—Ç Ultra</title>
  <style>
    :root {
      --bg: #1e1e1e;
      --fg: #ddd;
      --border: #444;
      --highlight: #4CAF50;
      --line: #2c2c2c;
    }
    body.light {
      --bg: #ffffff;
      --fg: #111;
      --border: #ccc;
      --highlight: #007acc;
      --line: #f0f0f0;
    }

    body {
      margin: 0;
      background-color: var(--bg);
      color: var(--fg);
      font-family: monospace;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      padding: 0.5em;
      background: var(--line);
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 0.5em;
      font-weight: bold;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
      margin: 0.5em;
    }

    .tab {
      background: var(--highlight);
      color: white;
      padding: 0.3em 0.8em;
      border-radius: 4px;
      cursor: pointer;
    }

    .tab.active {
      background: #333;
    }

    .controls {
      display: flex;
      gap: 0.5em;
      flex-wrap: wrap;
      margin: 0.5em;
    }

    .container {
      display: flex;
      flex: 1;
      overflow: hidden;
      min-height: 0;
    }

    .lines {
      background-color: var(--line);
      color: #888;
      padding: 1em 0.5em;
      text-align: right;
      user-select: none;
      font-size: 16px;
      overflow-y: hidden;
      white-space: pre;
      line-height: 1.5em;
    }

    textarea {
      flex: 1;
      background-color: var(--bg);
      color: var(--fg);
      border: none;
      resize: none;
      padding: 1em;
      font-size: 16px;
      line-height: 1.5em;
      font-family: monospace;
      outline: none;
      overflow-y: auto;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    button, label, select {
      background: var(--highlight);
      color: white;
      border: none;
      padding: 0.4em 0.8em;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
    }

    input[type="file"] {
      display: none;
    }

    #fileManager {
      margin: 0.5em;
      padding: 1em;
      background: var(--line);
      border-radius: 8px;
    }

    @media (max-width: 600px) {
      textarea { font-size: 14px; }
      .lines { font-size: 14px; }
    }
  </style>
</head>
<body>
  <header>
    <div>üìù <strong>–ë–ª–æ–∫–Ω–æ—Ç Ultra</strong></div>
    <div>
      <label><input type="checkbox" id="themeToggle"> üåô/üåû</label>
      <select id="fontSizeSelector">
        <option value="14">–®—Ä–∏—Ñ—Ç: 14</option>
        <option value="16" selected>16</option>
        <option value="18">18</option>
        <option value="20">20</option>
      </select>
    </div>
  </header>

  <div class="tabs" id="tabs"></div>

  <div class="container">
    <div class="lines" id="lines">1</div>
    <textarea id="note" spellcheck="true" placeholder="–ü–∏—à–∏ —Ç—É—Ç..."></textarea>
  </div>

  <div class="controls">
    <button onclick="newFile()">‚ûï –ù–æ–≤–∏–π —Ñ–∞–π–ª</button>
    <button onclick="saveCurrent()">üìÖ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    <label for="fileInput">üìÇ –í—ñ–¥–∫—Ä–∏—Ç–∏</label>
    <input type="file" id="fileInput" accept=".txt" />
    <button onclick="showFileManager()">üìÅ –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∞–π–ª—ñ–≤</button>
  </div>

  <div id="fileManager" style="display:none;">
    <h3>üìÅ –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∞–π–ª—ñ–≤</h3>
    <ul id="fileList"></ul>
    <button onclick="document.getElementById('fileManager').style.display='none'">–ó–∞–∫—Ä–∏—Ç–∏</button>
  </div>

  <script>
    const note = document.getElementById("note");
    const lines = document.getElementById("lines");
    const tabs = document.getElementById("tabs");
    const fontSizeSelector = document.getElementById("fontSizeSelector");

    let files = {};
    let currentFile = "–ë–µ–∑ –Ω–∞–∑–≤–∏";

    function updateLines() {
      const count = note.value.split("\n").length;
      const lineNumbers = [];
      for (let i = 1; i <= count; i++) {
        lineNumbers.push(i);
      }
      lines.textContent = lineNumbers.join("\n");
    }

    function switchTo(file) {
      saveCurrent();
      currentFile = file;
      note.value = files[file] || "";
      highlightActiveTab();
      updateLines();
    }

    function highlightActiveTab() {
      tabs.innerHTML = "";
      Object.keys(files).forEach(name => {
        const tab = document.createElement("div");
        tab.className = "tab" + (name === currentFile ? " active" : "");
        tab.textContent = name;
        tab.onclick = () => switchTo(name);
        tabs.appendChild(tab);
      });
    }

    function newFile() {
      const name = prompt("–ù–∞–∑–≤–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É:");
      if (!name || files[name]) return;
      files[name] = "";
      switchTo(name);
    }

    function saveCurrent() {
      files[currentFile] = note.value;
      localStorage.setItem("files", JSON.stringify(files));
    }

    function loadFromStorage() {
      const saved = localStorage.getItem("files");
      if (saved) {
        files = JSON.parse(saved);
        const first = Object.keys(files)[0];
        if (first) switchTo(first);
      } else {
        files["–ë–µ–∑ –Ω–∞–∑–≤–∏"] = "";
        switchTo("–ë–µ–∑ –Ω–∞–∑–≤–∏");
      }
    }

    document.getElementById("themeToggle").addEventListener("change", e => {
      document.body.classList.toggle("light", e.target.checked);
      localStorage.setItem("theme", e.target.checked ? "light" : "dark");
    });

    fontSizeSelector.addEventListener("change", e => {
      note.style.fontSize = e.target.value + "px";
      lines.style.fontSize = e.target.value + "px";
    });

    note.addEventListener("input", () => {
      updateLines();
      saveCurrent();
    });

    note.addEventListener("scroll", () => {
      lines.scrollTop = note.scrollTop;
    });

    document.getElementById("fileInput").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        const name = file.name.replace(".txt", "");
        files[name] = reader.result;
        switchTo(name);
      };
      reader.readAsText(file);
    });

    function showFileManager() {
      const list = document.getElementById("fileList");
      list.innerHTML = "";

      Object.keys(files).forEach(name => {
        const li = document.createElement("li");
        li.style.marginBottom = "0.5em";

        const span = document.createElement("span");
        span.textContent = name;
        span.style.marginRight = "1em";

        const renameBtn = document.createElement("button");
        renameBtn.textContent = "‚úèÔ∏è";
        renameBtn.onclick = () => {
          const newName = prompt("–ù–æ–≤–∞ –Ω–∞–∑–≤–∞ —Ñ–∞–π–ª—É:", name);
          if (!newName || newName === name || files[newName]) return;
          files[newName] = files[name];
          delete files[name];
          if (currentFile === name) currentFile = newName;
          saveCurrent();
          highlightActiveTab();
          showFileManager();
        };

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "‚ùå";
        deleteBtn.style.marginLeft = "0.5em";
        deleteBtn.onclick = () => {
          if (!confirm(`–í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–∞–π–ª "${name}"?`)) return;
          delete files[name];
          if (currentFile === name) {
            const next = Object.keys(files)[0] || "–ë–µ–∑ –Ω–∞–∑–≤–∏";
            files[next] ??= "";
            currentFile = next;
            note.value = files[currentFile];
          }
          saveCurrent();
          highlightActiveTab();
          showFileManager();
        };

        li.appendChild(span);
        li.appendChild(renameBtn);
        li.appendChild(deleteBtn);
        list.appendChild(li);
      });

      document.getElementById("fileManager").style.display = "block";
    }

    // Init
    loadFromStorage();
    updateLines();
    if (localStorage.getItem("theme") === "light") {
      document.body.classList.add("light");
      document.getElementById("themeToggle").checked = true;
    }
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üìù –ë–ª–æ–∫–Ω–æ—Ç Ultra</title>
  <style>
    :root {
      --bg: #1e1e1e;
      --fg: #ddd;
      --border: #444;
      --highlight: #4CAF50;
      --line: #2c2c2c;
    }
    body.light {
      --bg: #ffffff;
      --fg: #111;
      --border: #ccc;
      --highlight: #007acc;
      --line: #f0f0f0;
    }

    body {
      margin: 0;
      background-color: var(--bg);
      color: var(--fg);
      font-family: monospace;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      padding: 0.5em;
      background: var(--line);
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 0.5em;
      font-weight: bold;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
      margin: 0.5em;
    }

    .tab {
      background: var(--highlight);
      color: white;
      padding: 0.3em 0.8em;
      border-radius: 4px;
      cursor: pointer;
    }

    .tab.active {
      background: #333;
    }

    .controls {
      display: flex;
      gap: 0.5em;
      flex-wrap: wrap;
      margin: 0.5em;
    }

    .container {
      display: flex;
      flex: 1;
      overflow: hidden;
      min-height: 0;
    }

    .lines {
      background-color: var(--line);
      color: #888;
      padding: 1em 0.5em;
      text-align: right;
      user-select: none;
      font-size: 16px;
      overflow-y: hidden;
      white-space: pre;
      line-height: 1.5em;
    }

    textarea {
      flex: 1;
      background-color: var(--bg);
      color: var(--fg);
      border: none;
      resize: none;
      padding: 1em;
      font-size: 16px;
      line-height: 1.5em;
      font-family: monospace;
      outline: none;
      overflow-y: auto;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    button, label, select {
      background: var(--highlight);
      color: white;
      border: none;
      padding: 0.4em 0.8em;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
    }

    input[type="file"] {
      display: none;
    }

    #fileManager {
      margin: 0.5em;
      padding: 1em;
      background: var(--line);
      border-radius: 8px;
    }

    @media (max-width: 600px) {
      textarea { font-size: 14px; }
      .lines { font-size: 14px; }
    }
  </style>
</head>
<body>
  <header>
    <div>üìù <strong>–ë–ª–æ–∫–Ω–æ—Ç Ultra</strong></div>
    <div>
      <label><input type="checkbox" id="themeToggle"> üåô/üåû</label>
      <select id="fontSizeSelector">
        <option value="14">–®—Ä–∏—Ñ—Ç: 14</option>
        <option value="16" selected>16</option>
        <option value="18">18</option>
        <option value="20">20</option>
      </select>
    </div>
  </header>

  <div class="tabs" id="tabs"></div>

  <div class="container">
    <div class="lines" id="lines">1</div>
    <textarea id="note" spellcheck="true" placeholder="–ü–∏—à–∏ —Ç—É—Ç..."></textarea>
  </div>

  <div class="controls">
    <button onclick="newFile()">‚ûï –ù–æ–≤–∏–π —Ñ–∞–π–ª</button>
    <button onclick="saveCurrent()">üìÖ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    <label for="fileInput">üìÇ –í—ñ–¥–∫—Ä–∏—Ç–∏</label>
    <input type="file" id="fileInput" accept=".txt" />
    <button onclick="showFileManager()">üìÅ –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∞–π–ª—ñ–≤</button>
  </div>

  <div id="fileManager" style="display:none;">
    <h3>üìÅ –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∞–π–ª—ñ–≤</h3>
    <ul id="fileList"></ul>
    <button onclick="document.getElementById('fileManager').style.display='none'">–ó–∞–∫—Ä–∏—Ç–∏</button>
  </div>

  <script>
    const note = document.getElementById("note");
    const lines = document.getElementById("lines");
    const tabs = document.getElementById("tabs");
    const fontSizeSelector = document.getElementById("fontSizeSelector");

    let files = {};
    let currentFile = "–ë–µ–∑ –Ω–∞–∑–≤–∏";

    function updateLines() {
      const count = note.value.split("\n").length;
      const lineNumbers = [];
      for (let i = 1; i <= count; i++) {
        lineNumbers.push(i);
      }
      lines.textContent = lineNumbers.join("\n");
    }

    function switchTo(file) {
      saveCurrent();
      currentFile = file;
      note.value = files[file] || "";
      highlightActiveTab();
      updateLines();
    }

    function highlightActiveTab() {
      tabs.innerHTML = "";
      Object.keys(files).forEach(name => {
        const tab = document.createElement("div");
        tab.className = "tab" + (name === currentFile ? " active" : "");
        tab.textContent = name;
        tab.onclick = () => switchTo(name);
        tabs.appendChild(tab);
      });
    }

    function newFile() {
      const name = prompt("–ù–∞–∑–≤–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É:");
      if (!name || files[name]) return;
      files[name] = "";
      switchTo(name);
    }

    function saveCurrent() {
      files[currentFile] = note.value;
      localStorage.setItem("files", JSON.stringify(files));
    }

    function loadFromStorage() {
      const saved = localStorage.getItem("files");
      if (saved) {
        files = JSON.parse(saved);
        const first = Object.keys(files)[0];
        if (first) switchTo(first);
      } else {
        files["–ë–µ–∑ –Ω–∞–∑–≤–∏"] = "";
        switchTo("–ë–µ–∑ –Ω–∞–∑–≤–∏");
      }
    }

    document.getElementById("themeToggle").addEventListener("change", e => {
      document.body.classList.toggle("light", e.target.checked);
      localStorage.setItem("theme", e.target.checked ? "light" : "dark");
    });

    fontSizeSelector.addEventListener("change", e => {
      note.style.fontSize = e.target.value + "px";
      lines.style.fontSize = e.target.value + "px";
    });

    note.addEventListener("input", () => {
      updateLines();
      saveCurrent();
    });

    note.addEventListener("scroll", () => {
      lines.scrollTop = note.scrollTop;
    });

    document.getElementById("fileInput").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        const name = file.name.replace(".txt", "");
        files[name] = reader.result;
        switchTo(name);
      };
      reader.readAsText(file);
    });

    function showFileManager() {
      const list = document.getElementById("fileList");
      list.innerHTML = "";

      Object.keys(files).forEach(name => {
        const li = document.createElement("li");
        li.style.marginBottom = "0.5em";

        const span = document.createElement("span");
        span.textContent = name;
        span.style.marginRight = "1em";

        const renameBtn = document.createElement("button");
        renameBtn.textContent = "‚úèÔ∏è";
        renameBtn.onclick = () => {
          const newName = prompt("–ù–æ–≤–∞ –Ω–∞–∑–≤–∞ —Ñ–∞–π–ª—É:", name);
          if (!newName || newName === name || files[newName]) return;
          files[newName] = files[name];
          delete files[name];
          if (currentFile === name) currentFile = newName;
          saveCurrent();
          highlightActiveTab();
          showFileManager();
        };

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "‚ùå";
        deleteBtn.style.marginLeft = "0.5em";
        deleteBtn.onclick = () => {
          if (!confirm(`–í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–∞–π–ª "${name}"?`)) return;
          delete files[name];
          if (currentFile === name) {
            const next = Object.keys(files)[0] || "–ë–µ–∑ –Ω–∞–∑–≤–∏";
            files[next] ??= "";
            currentFile = next;
            note.value = files[currentFile];
          }
          saveCurrent();
          highlightActiveTab();
          showFileManager();
        };

        li.appendChild(span);
        li.appendChild(renameBtn);
        li.appendChild(deleteBtn);
        list.appendChild(li);
      });

      document.getElementById("fileManager").style.display = "block";
    }

    // Init
    loadFromStorage();
    updateLines();
    if (localStorage.getItem("theme") === "light") {
      document.body.classList.add("light");
      document.getElementById("themeToggle").checked = true;
    }
  </script>
</body>
</html>
